---
title: "Report for One Day of Week"
author: "Rachel Keller"
date: "October 16, 2020"
output: rmarkdown::github_document
params: 
  dayofWeek: NULL
---
# Introduction

The data we will be analyzing in this project is a daily count of rental bikes between years 2011 and 2012 in the Capital bikeshare system. This bike share data set includes information about the day of rental and the weather on that particular day. Below is a list of the variables that will be available for us to include in our models and a brief description:

* instant: record index
* dteday : date
* season : season (1:winter, 2:spring, 3:summer, 4:fall)
* yr : year (0: 2011, 1:2012)
* mnth : month ( 1 to 12)
* hr : hour (0 to 23)
* holiday : weather day is holiday or not
* weekday : day of the week
* workingday : if day is neither weekend nor holiday is 1, otherwise is 0
* weathersit :
  + 1: Clear, Few clouds, Partly cloudy, Partly cloudy
  + 2: Mist + Cloudy, Mist + Broken clouds, Mist + Few clouds, Mist
  + 3: Light Snow, Light Rain + Thunderstorm + Scattered clouds, Light Rain + Scattered clouds
  + 4: Heavy Rain + Ice Pallets + Thunderstorm + Mist, Snow + Fog
* temp : Normalized temperature in Celsius
* atemp: Normalized feeling temperature in Celsius
* hum: Normalized humidity
* windspeed: Normalized wind speed
* cnt: count of total rental bikes

```{r}
set.seed(123)
library(tidyverse)
library(caret)
```

Group B Data:
```{r, message = FALSE}
bikeData <- read_csv("day.csv")
bikeData$dteday <- as.Date(bikeData$dteday, format = "%m/%d/%Y")
bikeData <- bikeData %>% select(-c(casual, registered)) %>% filter(weekday == params$dayofWeek)
str(bikeData)
```

```{r}
bikeDataIndex <- createDataPartition(bikeData$cnt, p = 0.7, list = FALSE)
bikeDataTrain <- bikeData[bikeDataIndex, ]
bikeDataTest <- bikeData[-bikeDataIndex, ]
```

```{r, warning=FALSE}
(treeFit <- train(cnt ~ ., data = bikeDataTrain,
               method = "rpart",
               preProcess = c("center", "scale"),
               trControl = trainControl(method = "LOOCV")))
```

```{r, warning=FALSE}
(boostedtreeFit <- train(cnt ~ ., data = bikeDataTrain,
               method = "gbm",
               preProcess = c("center", "scale"),
               trControl = trainControl(method = "LOOCV"),
               verbose = FALSE))
```

```{r}
treePred <- predict(treeFit, newdata = bikeDataTest)
postResample(treePred, bikeDataTest$cnt)
```

```{r}
boostedtreePred <- predict(boostedtreeFit, newdata = bikeDataTest)
postResample(boostedtreePred, bikeDataTest$cnt)
```
